# NOTE:
#   This is the base configuration file defining all
#   known variables and their respective default values.
#
#   Collections may override this as needed.
#
#   Do not edit this file directly.
#   Instead, create a file containing
#   your customizations in <project root>/profiles/.
#   
#   Typically, at least DBUILD_TARGET_COLLECTIONS must be set there.
#

# Build environment
# -----------------

# Proxy URL to be used during mmdebstrap
#DBUILD_APT_PROXY='http://localhost:3142'
DBUILD_APT_PROXY=''

# Base path for temporary files and directories
#
#  If empty, the staging root directory will be used.
#
DBUILD_TMPDIR_ROOT=''

DBUILD_TARGET_ARCH='amd64'
DBUILD_TARGET_CODENAME='bullseye'
DBUILD_TARGET_COMPONENTS='main'

DBUILD_TARGET_VARIANT='apt'

# List of collections to use
#
#   Each collection provides configuration for the target.
#   Several collections may be listed.
#   
#   Some collections conflict, e.g. systemd <> sysvinit,
#   but usually it is safe to mix collections.
#
#   Must not be empty - should be set in the profile config.
#
DBUILD_TARGET_COLLECTIONS=''

# Init system used by the target,
# typically either systemd or sysvinit
#
#   This should not be set manually.
#   Include the corresponding collection instead,
#   which also provides necessary shell helpers,
#   e.g. for enable services. 
#
DBUILD_TARGET_INIT_SYSTEM='unknown'


# User Accounts
# -------------

# By default, two unprivileged users will be created:
# - a login user that may elevate to root via su(1)
# - an additional user that may not log in and to whom only root can switch
#   via su -l -s /bin/ksh <name>.
#   This user account is meant for unprivileged admin purposes.
#
# The users will be named cosmo & wanda unless overridden in config.local.
#

# Password for root
#   This may be a plain password or a hash (starting with '$').
#   Password beginning with a literal '$' must be provided in hashed form.
OCONF_INSTALL_ROOT_PASSWORD=''

# login user (REQUIRED)
#
#  Specify the user name here, the uid will be 1000.
#
#  No passphrase will be set ('*' as password hash).
#
#  SSH access can be disabled by setting OFEAT_LOGIN_USER_SSH=0
#  and fine-tuned via OFEAT_LOGIN_USER_SSH_<access_group>=0|1.
#
OFEAT_LOGIN_USER=1
OFEAT_LOGIN_USER_RAMDISK=0
OCONF_LOGIN_USER_RAMDISK_SIZE=1
OFEAT_LOGIN_USER_SSH=1
OFEAT_LOGIN_USER_SSH_SHELL=1
OFEAT_LOGIN_USER_SSH_FORWARDING=0
OCONF_LOGIN_USER='cosmo'
OCONF_LOGIN_UID='1000'

# Password for the login user
#   This may be a plain password or a hash (starting with '$').
#   Password beginning with a literal '$' must be provided in hashed form.
OCONF_LOGIN_USER_PASSWORD=''

# SSH public key for the login user
#
#  If unset, the login user may still login via SSH using password auth.
#
#OCONF_INSTALL_LOGIN_USER_SSH_PUB_KEY='ssh-rsa ...'

# unprivileged user
#
#   Set the user name and its uid here.
#   The passphrase will be set to "login disabled" (thirteen asterisk chars),
#   it can not be controlled here.
#
#   Can be disabled by setting the user name to the empty string.
#
OFEAT_UNPRIV_USER=1
OCONF_UNPRIV_USER='wanda'
OCONF_UNPRIV_UID='1001'

# control user
#  You may optionally configure a user for automated control purposes
#  (configuration management / orchestration, e.g. Ansible).
#
#  The user will be granted sudo privileges in NOPASS mode.
#
#  The home directory will be empty.
#  By default, a ramdisk of roughly 120m in size will be created.
#
#  This user will be able to log in via SSH with public keys only.
#  Public keys are managed in /etc/ssh/authorized_keys/<user>.
#  You may also configure a single key here.
#
#  Notes:
#    - sudo(8) will be configured for that user only,
#      overriding any other configuration
#    - OFEAT_CTRL_USER_SSH defaults to 1
#      (capped by OFEAT_CTRL_USER)
#
OFEAT_CTRL_USER=0
OFEAT_CTRL_USER_RAMDISK=1
OCONF_CTRL_USER_RAMDISK_SIZE=50
OCONF_CTRL_USER='ctrl'
OCONF_CTRL_UID='999'
OFEAT_CTRL_USER_SSH=1
OFEAT_CTRL_USER_SSH_SHELL=1
OFEAT_CTRL_USER_SSH_FORWARDING=0
OCONF_CTRL_SSH_KEY=''
#OCONF_CTRL_SSH_FROM='' ## NOT_IMPLEMENTED

# SSH Server
# ----------

# Whether to generate /etc/ssh/sshd_config from template
#
#   Basic and very restrictive configuration.
#
#   Access is granted based on group membership ("ssh-<access>"):
#
#     - Only members in the 'login' this group may log in,
#       regardless of any other ssh-* membership
#
#     - The 'shell' group grants access to a PTY
#
#     - The 'forwarding' group enables TCP forwarding
#
#   The names and ids of these groups may be changed below.
#
#   For the builtin user accounts,
#   the default permissions are as follows:
#
#     - login  (OCONF_LOGIN_USER)  : login, shell
#     - ctrl   (OCONF_CTRL_USER)   : login, shell
#     - unpriv (OCONF_UNPRIV_USER) : no access [not configurable]
#     - root   (<system user>)     : no access [not configurable]
#
OFEAT_SSHD_CONFIG=1

# SSH access group names and their ids, mandatory
#
#  An error is raised if a group is missing but its gid is already taken.
#  If a group with that name does already exist, its gid will remain unchanged.
#
OCONF_SSHD_GROUP_LOGIN="ssh-login"
OCONF_SSHD_GID_LOGIN="900"

OCONF_SSHD_GROUP_SHELL="ssh-shell"
OCONF_SSHD_GID_SHELL="901"

OCONF_SSHD_GROUP_FORWARDING="ssh-forwarding"
OCONF_SSHD_GID_FORWARDING="902"

# Packages Installation
# ---------------------

# feature: Whether to install packages listed in OCONF_PKG_INSTALL on first boot
OFEAT_PKG_INSTALL=1

# List of packages to be installed
OCONF_PKG_INSTALL=""

# feature: install 
OFEAT_ANSIBLE_CTRL=0

# System Configuration
# --------------------

# Hostname
OCONF_HOSTNAME='staging'

# Keyboard Layout
#
#   Examples: us
#
#  TODO/NOTE: NOT IMPLEMENTED
OCONF_KBD_LAYOUT=''

# Timezone
#
#   This must be the name of a timezone file
#   as present in /usr/share/zoneinfo/,  e.g. 'UTC' or 'Europe/Berlin'.
#   FIXME: must be <region>/<name>, not UTC
#
OCONF_TIMEZONE='Europe/Berlin'

# Predictable Network Interface Names
#
#   Set to 1 to enable, 0 to disable renaming of network interfaces.
#
#   See also:
#     https://wiki.debian.org/NetworkInterfaceNames
#     https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/
#
OFEAT_IFNAMES=1

# Downsize the target rootfs by excluding non-essential files
#
OFEAT_ROOTFS_MINIMAL=0
OFEAT_ROOTFS_MINIMAL_USR_SHARE=0

# Whether to install man pages
#
#   This is usually a good idea..
#
OFEAT_MAN_PAGES=0

# Whether to install the cron daemon
#
#   Not strictly necessary (especially when using systemd timers), but it's
#   unknown to me how much Debian relies on it on for normal operation.
#
OFEAT_CRON=1

# Whether to install rsyslog
#
#   By default, no syslog daemon is installed.
#   For systemd hosts, only a volatile journal will be configured.
#
OFEAT_RSYSLOG=0
